import os
import shutil
import pandas as pd

def arrange_files(excel_file, source_folder, destination_folder):
    # Read the Excel file
    df = pd.read_excel(excel_file)

    # Create destination folders if they don't exist
    for label in df['label'].unique():
        folder_path = os.path.join(destination_folder, str(label))
        os.makedirs(folder_path, exist_ok=True)

    # Move files to respective folders
    for index, row in df.iterrows():
        file_name = row['file_name']
        label = row['label']

        source_file_path = os.path.join(source_folder, file_name)
        destination_folder_path = os.path.join(destination_folder, str(label))

        if os.path.exists(source_file_path):
            shutil.move(source_file_path, destination_folder_path)
            print(f"Moved file: {file_name} to folder: {label}")
        else:
            print(f"File not found: {file_name}")

# Example usage
excel_file = 'D:/Fasion_detection/train.xlsx'  # Replace with your Excel file path
source_folder = 'D:/Fasion_detection/train'  # Replace with your source folder path
destination_folder = 'D:/Fasion_detection/train_l'  # Replace with your destination folder path

arrange_files(excel_file, source_folder, destination_folder)
